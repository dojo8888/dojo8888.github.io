<!DOCTYPE html>
<html>
  <head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="description" content="">
	<meta name="author" content="">

	<link rel="icon" href="favicon.ico">
	<link rel="manifest" href="manifest.json">
	<title>TEST</title>    
	<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
	<script src="//code.jquery.com/jquery.min.js"></script>
  </head>
<body>
<script src="https://www.gstatic.com/firebasejs/3.7.2/firebase.js"></script>
<script type="text/javascript">

var config = {
				apiKey: "AIzaSyB9zcIc1TpWX76Y9idkUgzPsDQrfCrW-T0",
				authDomain: "tank-6d5d3.firebaseapp.com",
				databaseURL: "https://tank-6d5d3.firebaseio.com",
				storageBucket: "tank-6d5d3.appspot.com",
				messagingSenderId: "918636476327"
			};

firebase.initializeApp(config);
var messaging = firebase.messaging();

messaging.onMessage(function(payload) {
	console.log('onMessage: ', payload);
});

// On load register service worker
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    navigator.serviceWorker.register('/firebase-messaging-sw.js').then((registration) => {
      // Successfully registers service worker
      console.log('ServiceWorker registration successful with scope: ', registration.scope);
      messaging.useServiceWorker(registration);
    })
    .then(() => {
      // Requests user browser permission
      return messaging.requestPermission();
    })
    .then(() => {
      // Gets token
      return messaging.getToken();
    })
    .then((token) => {
      // Simple ajax call to send user token to server for saving
      console.log(token);
      // $.ajax({
      //   type: 'POST',
      //   url: '/api/setToken',
      //   dataType: 'json',
      //   data: JSON.stringify({token: token}),
      //   contentType: 'application/json',
      //   success: (data) => {
      //     console.log('Success ', data);
      //   },
      //   error: (err) => {
      //     console.log('Error ', err);
      //   }
      // })
    })
    .catch((err) => {
      console.log('ServiceWorker registration failed: ', err);
    });
  });
}


  

</script>
</body>
</html>