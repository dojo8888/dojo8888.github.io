<!doctype html>
<html>
   <head>
      <title>Multi-Source Audio Player</title>
      <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
      <meta name = "viewport" content = "width=device-width">
   </head>

   <body>
         <h1 id="currentTime">currentTime </h1>
         <h1 id="durationTime">durationTime </h1>

         <a href="javascript:AudioStart()"><h1> AudioStart</h1></a> 

         <a href="javascript:TogglePlayPause()"><h1> TogglePlayPause</h1></a> 

         <a href="javascript:NextTrack()"><h1> NextTrack</h1></a> 

         <a href="javascript:PreviousTrack()"><h1> PreviousTrack</h1></a> 
  </body>


  <script>     
         // 재생 progress bar 표시용 타이머
      var currentTimer;

      // 현재 플레이 중 인 아이템 재생 총 시간
      var audioDurationValue = 0;

      // 현재 플레이 중 인 아이템 현재 재생 타임 
      var audioCurrentTimeValue = 0;

      // 테스트용 : 표시 테그
      var currentTimeTag = document.getElementById('currentTime');
      var durationTimeTag = document.getElementById('durationTime');

         // 아이폰 : 재생목록 플레이
         function AudioStart(){

            // 타이틀 , 재생음악 주소
            // http://mc.webworld.kr:81
            // http://192.168.25.48:8000
            var playlist = [{"title": "재생목록 1", "url": "https://dojo8888.github.io/audioPlayer/audio1.mp3"},
                     {"title": "재생목록 2", "url": "https://dojo8888.github.io/audioPlayer/audio2.mp3"},
                     {"title": "재생목록 3", "url": "https://dojo8888.github.io/audioPlayer/audio3.mp3"},
                     {"title": "재생목록 4", "url": "https://dojo8888.github.io/audioPlayer/audio4.mp3"}]

            // 아이폰 음악 플레이어 재생 시작
         if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.AudioStart){
            window.webkit.messageHandlers.AudioStart.postMessage(playlist);   
            
            // 현 재생 타임  , 총 재생 시간 확인
            setInterval(function(){ 
                  CurrentTime(); // 현 재생 타임
                  currentTimeTag.innerText = audioCurrentTimeValue; // 현 재생 타임 값 표시

                  Duration(); // 총 재생 시간 확인
                  durationTimeTag.innerText = audioDurationValue;  // 총 재생 시간 값 표시
                  
               }, 100);
            }  
         }

         // 총 재생 길이
         function Duration(){
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.Duration){
               window.webkit.messageHandlers.Duration.postMessage("audioDurationValue");
            }
         }

         // 현 재생 타임 
         function CurrentTime(){
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.CurrentTime){
              window.webkit.messageHandlers.CurrentTime.postMessage("audioCurrentTimeValue");   
            }
         }

         // 플레이/스탑
         function TogglePlayPause(){
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.TogglePlayPause){
              window.webkit.messageHandlers.TogglePlayPause.postMessage({});  
            }
         }

         // 이전 트렉
         function PreviousTrack(){
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.PreviousTrack){
              window.webkit.messageHandlers.PreviousTrack.postMessage({}); 
            }
         }

         // 현재 트렉
         function NextTrack(){
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.NextTrack){
              window.webkit.messageHandlers.NextTrack.postMessage({});  
            }
         }

     </script>


</html>
