<!doctype html>
<html>
   <head>
      <title>Multi-Source Audio Player</title>
      <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
      <meta name = "viewport" content = "width=device-width">
   </head>

   <body>
         <h1 id="title">title </h1>
         <h1 id="currentTime">currentTime </h1>
         <h1 id="durationTime">durationTime </h1>


         <h1> IOS </h1>
         <a href="javascript:AudioStart()"><h1> AudioStart</h1></a> 

         <a href="javascript:TogglePlayPause()"><h1> TogglePlayPause</h1></a> 

         <a href="javascript:NextTrack()"><h1> NextTrack</h1></a> 

         <a href="javascript:PreviousTrack()"><h1> PreviousTrack</h1></a> 


         <a href="javascript:SeekTo(50)"><h1> SeekTo 50%</h1></a> 

         <h1> 안드로이드 </h1>

         <a href="javascript:androidTestStart()"><h1> androidTestStart</h1></a> 

         <a href="javascript:android_audioStart('재생목록 2');"><h1> audioStart('재생목록 2');</h1></a> 

         <a href="javascript:android_audioStop();"><h1> audioStop</h1></a> 
         
  </body>


  <script>     
      // https://github.com/dojo8888/dojo8888.github.io/tree/master/audioPlayer


      // 현재 플레이 중 인 아이템 재생 총 시간
      var audioDurationValue = 0;

      // 현재 플레이 중 인 아이템 현재 재생 타임 
      var audioCurrentTimeValue = 0;

      // 테스트용 : 표시 테그
      var titleTag = document.getElementById('title');
      var currentTimeTag = document.getElementById('currentTime');
      var durationTimeTag = document.getElementById('durationTime');

         // 아이폰 : 재생목록 플레이
         function AudioStart(){

            // 타이틀 , 재생음악 주소
            // http://mc.webworld.kr:81
            // http://192.168.25.48:8000
            // https://dojo8888.github.io/audioPlayer
            var playlist = [{"title": "재생목록 1", "url": "https://dojo8888.github.io/audioPlayer/audio1.mp3"},
                     {"title": "재생목록 2", "url": "https://dojo8888.github.io/audioPlayer/audio2.mp3"},
                     {"title": "재생목록 3", "url": "https://dojo8888.github.io/audioPlayer/audio3.mp3"},
                     {"title": "재생목록 4", "url": "https://dojo8888.github.io/audioPlayer/audio4.mp3"}]

            // 아이폰 음악 플레이어 재생 시작
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.AudioStart){
               window.webkit.messageHandlers.AudioStart.postMessage(playlist);   
            }
         }

         // 플레이/스탑
         function TogglePlayPause(){
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.TogglePlayPause){
              window.webkit.messageHandlers.TogglePlayPause.postMessage({});  
            }
         }

         // 이전 트렉
         function PreviousTrack(){
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.PreviousTrack){
              window.webkit.messageHandlers.PreviousTrack.postMessage({}); 
            }
         }

         // 현재 트렉
         function NextTrack(){
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.NextTrack){
              window.webkit.messageHandlers.NextTrack.postMessage({});  
            }
         }

         // 플레이어 프로그래스바 현재 재생 타임 조정
         function SeekTo(percent){
            if (window.webkit && window.webkit.messageHandlers && window.webkit.messageHandlers.SeekTo){
              window.webkit.messageHandlers.SeekTo.postMessage(percent);  
            }
         }

         // 아이폰에서 호출되는 함수 (현재 재생 타임 , 총 재생 타임)
         function iOSAudioStarted(title, currentSec, durationSec){
            titleTag.innerText = title;
            currentTimeTag.innerText = currentSec;
            durationTimeTag.innerText = durationSec;
         }

         // 아이폰에서 호출되는 함수 (재생 스탑 신호)
         function iOSAudioStopped(){
            currentTimeTag.innerText = "STOP";
            durationTimeTag.innerText = "STOP";
         }


         var audio = new Audio('https://dojo8888.github.io/audioPlayer/audio1.mp3');
         audio.addEventListener('ended', playNextTrack, false);

         function androidTestStart(){
            audio.play();
            android_audioStart("재생목록 1번 제목");
         }


         function android_audioStart(title){
            if (typeof androidBridge != "undefined" && androidBridge.audioStart) {
               alert("androidBridge.audioStart");
               androidBridge.audioStart(title);
            }else{
               alert("ERROR : androidBridge.audioStart UNDIFINED");
            }
         }

         function android_audioStop(){
            if (typeof androidBridge != "undefined" && androidBridge.audioStop) {
               alert("androidBridge.audioStop");
                  androidBridge.audioStop();
            }else{
               alert("ERROR : androidBridge.audioStop UNDIFINED");
            }
         }

         var AV = {
            "androidStopAudio"  : function(){
               alert("AP.androidStopAudio");
               audio.stop();
            }
         }

         function playNextTrack(){
            if (audio.src != "https://dojo8888.github.io/audioPlayer/audio2.mp3"){
               audio.src = "https://dojo8888.github.io/audioPlayer/audio2.mp3";
               audio.play();
               android_audioStart("재생목록 2번 제목");
            }else{
               android_audioStop();
            }
         }


     </script>


</html>
